<?xml version="1.0" encoding="UTF-8" ?>
<Script ObjectRecordID="1000009">
	<FileName href="" />
	<ScriptText>--------------------------------------------------Start_mission_Tubruk_2.0

function RevealObjective0()
	GiveObjective( 0 );
	StartThread( Objective0 );
end;

function Objective0()
	while 1 do
		Wait( 3 );
		if ((GetNUnitsInArea(1, &quot;Def1&quot;, 0) &lt; 2) and (GetNUnitsInArea(1, &quot;Def2&quot;, 0) &lt; 2)) then
			CompleteObjective( 0 );
			DamageScriptObject ( 5001, 100 )
			SetIGlobalVar( &quot;temp.objective0&quot;, 2 );
			Wait( 2 );
			break;
		end;	
	end;
end;
--------------------------------------------------W_Fort
function RevealObjective1()
	while 1 do
		Wait( 3 );
		if ((GetNUnitsInArea(0, &quot;W_fort&quot;, 0) &gt; 0) or (GetIGlobalVar(&quot;temp.objective0&quot;, 1) == 2)) then
			Wait( 2 );
			GiveObjective( 1 );
			DamageScriptObject ( 5002, 10 )
			ViewZone (&quot;w2&quot;, 1)
			ViewZone (&quot;w2&quot;, 0)
			StartThread( Objective1 );
			break;
		end;	
	end;
end;

function Objective1()
	while 1 do
		Wait( 3 );
		if (GetNUnitsInArea(1, &quot;W_fort&quot;, 0) &lt; 1) then
			CompleteObjective( 1 );
			DamageScriptObject ( 5002, 40 )
			SetIGlobalVar( &quot;temp.objective1&quot;, 2 );
			Wait( 2 );
			LandReinforcementFromMap( 0, 0, 4, 394 );
			break;
		end;	
	end;
end;
-------------------------------------------------GB_Tanks
function RevealObjective2()
	while 1 do
		Wait( 3 );
		if ((GetNUnitsInArea(0, &quot;Tanks&quot;, 0) &gt; 0) or (GetIGlobalVar(&quot;temp.objective1&quot;, 1) == 2)) then
			Wait( 2 );
			GiveObjective( 2 );
			DamageScriptObject ( 5003, 10 )
			ViewZone (&quot;w3&quot;, 1)
			ViewZone (&quot;w3&quot;, 0)
			StartThread( Objective2 );
			break;
		end;	
	end;
end;

function Objective2()
	while 1 do
		Wait( 3 );
		if ( GetNUnitsInScriptGroup( 222 ) &lt; 2 ) then
			CompleteObjective( 2 );
			DamageScriptObject ( 5003, 40 )
			SetIGlobalVar( &quot;temp.objective2&quot;, 2 );
			Wait( 2 );
			break;
		end;	
	end;
end;
--------------------------------------------------Village
function RevealObjective3()
	while 1 do
		Wait( 3 );
		if ((GetNUnitsInArea(0, &quot;Village&quot;, 0) &gt; 0) or (GetIGlobalVar(&quot;temp.objective2&quot;, 1) == 2)) then
			Wait( 2 );
			GiveObjective( 3 );
			DamageScriptObject ( 5004, 10 )
			ViewZone (&quot;w4&quot;, 1)
			ViewZone (&quot;w4&quot;, 0)
			StartThread( Objective3 );
			break;
		end;	
	end;
end;

function Objective3()
	while 1 do
		Wait( 3 );
		if ((GetNUnitsInArea(1, &quot;Village&quot;, 0) &lt; 1) and (GetNUnitsInArea(0, &quot;Village&quot;, 0) &gt; 0)) then
			CompleteObjective( 3 );
			DamageScriptObject ( 5004, 40 )
			SetIGlobalVar( &quot;temp.objective3&quot;, 2 );
			Wait( 2 );
			StartThread( Italo_2 );
			StartThread( Italo_3 );
			StartThread( Italo_4 );
			break;
		end;	
	end;
end;

function Italo_2()
	Wait( 3 );
	LandReinforcementFromMap( 2, &quot;IT_INF&quot;, 3, 5099 );
	Wait( 3 );
	ChangeFormation( 311, 3 );
	Cmd( 3, 5099, 500, 5981, 9863 ); 
end;

function Italo_3()
	Wait( 30 );
	LandReinforcementFromMap( 2, &quot;IT_TANKS&quot;, 3, 5098 );
	Wait( 2 );
	Cmd( 3, 5098, 500, 5981, 9863 ); 
end;

function Italo_4()
	Wait( 40 );
	LandReinforcementFromMap( 0, &quot;ITALO_SPG&quot;, 3, 5097 );
end;

--------------------------------------------------Tubruk
function RevealObjective4()
	while 1 do
		Wait( 3 );
		if ((GetNUnitsInArea(0, &quot;Tubruk&quot;, 0) &gt; 0) or (GetIGlobalVar(&quot;temp.objective3&quot;, 1) == 2)) then
			Wait( 2 );
			GiveObjective( 4 );
			DamageScriptObject ( 5005, 10 )
			ViewZone (&quot;w5&quot;, 1)
			ViewZone (&quot;w5&quot;, 0)
			StartThread( Objective4 );
			break;
		end;	
	end;
end;

function Objective4()
	while 1 do
		Wait( 3 );
		if ((GetNUnitsInArea(1, &quot;Tubruk&quot;, 0) &lt; 4) and (GetNUnitsInArea(0, &quot;Tubruk&quot;, 0) &gt; 0)) then
			Wait( 2 );
			CompleteObjective( 4 );
			DamageScriptObject ( 5005, 40 )
			SetIGlobalVar( &quot;temp.objective4&quot;, 2 );
			Wait( 2 );
			break;
		end;	
	end;
end;


--------------------------------------------------I_Attacks
function Attack_I() 
	while 1 do
		Wait( 2 );
			if ((GetNUnitsInArea(1, &quot;W_fort&quot;, 0) &gt; 4) and (GetIGlobalVar(&quot;temp.objective0&quot;, 1) == 2)) then
			Wait( 1 );
			StartThread( Rand_Italo );
			break;
		end;
	end;
end;

function Rand_Italo()
local x = RandomInt(2);
	if x == 0 then
	StartThread( I1 );
	end;
	if x == 1 then
	StartThread( I2 );
	end;
end;

function I1()
	Wait( 5 );
	LandReinforcementFromMap( 2, &quot;IT_INF&quot;, 0, 311 );
	LandReinforcementFromMap( 2, &quot;IT_TANKS&quot;, 1, 312 );
	LandReinforcementFromMap( 2, &quot;IT_INF&quot;, 2, 313 ); 
	Wait( 2 );
	ChangeFormation( 311, 3 );
	ChangeFormation( 313, 3 );
	Wait( 3 );
	Cmd ( 3 , 311 , 0 , GetScriptAreaParams&quot;IT1&quot; );
	Cmd ( 3 , 312 , 0 , GetScriptAreaParams&quot;IT1_1&quot; );
	Cmd ( 3 , 313 , 0 , GetScriptAreaParams&quot;IT1_2&quot; );
	QCmd ( 3 , 311 , 0 , GetScriptAreaParams&quot;IT2&quot; );
	QCmd ( 3 , 312 , 0 , GetScriptAreaParams&quot;IT2&quot; );
	QCmd ( 3 , 313 , 0 , GetScriptAreaParams&quot;IT2&quot; );
	QCmd ( 3 , 311 , 0 , GetScriptAreaParams&quot;IT3&quot; );
	QCmd ( 3 , 312 , 0 , GetScriptAreaParams&quot;IT3&quot; );
	QCmd ( 3 , 313 , 0 , GetScriptAreaParams&quot;IT3&quot; );
	Wait( 160 + RandomInt( 60 ) );
	StartThread( Attack_I );
end;

function I2()
	Wait( 5 );
	LandReinforcementFromMap( 2, &quot;IT_TANKS&quot;, 0, 314 );
	LandReinforcementFromMap( 2, &quot;IT_INF&quot;, 1, 315 );
	LandReinforcementFromMap( 2, &quot;IT_TANKS&quot;, 2, 316 ); 
	Wait( 2 );
	ChangeFormation( 315, 3 );
	Wait( 3 );
	Cmd ( 3 , 314 , 0 , GetScriptAreaParams&quot;IT1&quot; );
	Cmd ( 3 , 315 , 0 , GetScriptAreaParams&quot;IT1_1&quot; );
	Cmd ( 3 , 316 , 0 , GetScriptAreaParams&quot;IT1_2&quot; );
	QCmd ( 3 , 314 , 0 , GetScriptAreaParams&quot;IT2&quot; );
	QCmd ( 3 , 315 , 0 , GetScriptAreaParams&quot;IT2&quot; );
	QCmd ( 3 , 316 , 0 , GetScriptAreaParams&quot;IT2&quot; );
	QCmd ( 3 , 314 , 0 , GetScriptAreaParams&quot;IT3&quot; );
	QCmd ( 3 , 315 , 0 , GetScriptAreaParams&quot;IT3&quot; );
	QCmd ( 3 , 316 , 0 , GetScriptAreaParams&quot;IT3&quot; );
	Wait( 160 + RandomInt( 60 ) );
	StartThread( Attack_I );
end;
---------------------------------------------------Italo_avia
function Attack_Avia() 
	while 1 do
		Wait( 2 );
			if ((GetIGlobalVar(&quot;temp.objective0&quot;, 1) == 2) and (GetIGlobalVar(&quot;temp.objective1&quot;, 1) ~= 2)) then
			Wait( 1 );
			StartThread( Avia );
			break;
		end;
	end;
end;

function Avia()
	Wait( 10 );
	LandReinforcementFromMap( 2, &quot;IT_AVIA&quot;, 0, 511 ); 
	Cmd( 0, 511, 1000, 3240, 4631 );
	Wait( 140 + RandomInt( 100 ) );
	StartThread( Attack_Avia );
end;
------------------------
function Start_Italo()
	Wait( 25 );
	LandReinforcementFromMap( 2, &quot;IT_INF&quot;, 0, 6776 ); 
	Wait( 2 );
	Cmd( 3, 6776, 50, 1689, 3675 );
	QCmd( 3, 6776, 50, 4177, 5775 );
	QCmd( 3, 6776, 50, 7294, 11565 );
end;
-----------------------------------------------------W_FORT_DEFEND
function Fort_Def() 
	while 1 do
		Wait( 2 );
			if ((GetNUnitsInArea(1, &quot;W_fort&quot;) &lt; 12) and (GetNUnitsInArea(0, &quot;W_fort&quot;) &lt; 2) and (GetIGlobalVar(&quot;temp.objective1&quot;, 1) ~= 2)) then
			Wait( 1 );
			StartThread( GB_REINF_1 );
			break;
		end;
	end;
end;

function GB_REINF_1()
	Wait( 3 );
	LandReinforcementFromMap( 1, &quot;GB_TANKS&quot;, 1, 2132 ); 
	Wait( 2 );
	Cmd ( 3 , 2132 , 0 , GetScriptAreaParams&quot;GB1&quot; );
	QCmd ( 3 , 2132 , 0 , GetScriptAreaParams&quot;GB2&quot; );
	Wait( 5 );
	StartThread( Fort_2 );
end;

function Fort_2() 
	while 1 do
		Wait( 2 );
			if (( GetNUnitsInScriptGroup( 2132 ) &lt; 2 ) and (GetIGlobalVar(&quot;temp.objective1&quot;, 1) ~= 2 )) then
			Wait( 1 );
			StartThread( GB_REINF_1 );
			break;
		end;
	end;
end;

----------------------------------------------------Winners
function Winner()
	while 1 do
		Wait( 3 );
		if ((GetIGlobalVar(&quot;temp.objective1&quot;, 1) == 2) and (GetIGlobalVar(&quot;temp.objective4&quot;, 1) == 2)) then
			Wait( 3 );
			Win(0);
			break;
		end;	
	end;
end;

function Unlucky()
    while 1 do
        if (( GetNUnitsInParty(0) &lt; 1) and ( GetReinforcementCallsLeft( 0 ) == 0 )) then
			Wait(3);
			Win(1);
        return 1;
	end;
	Wait(5);
	end;
end;
-----------------------------------------------------StartGB_attack
function StartGB()
	Wait( 20 );
	while 1 do
		Wait( 2 );
		if (GetNUnitsInArea(0, &quot;A1&quot;, 0) &lt; 3) then
			Wait( 2 );
			StartThread( GB_attack );
			Wait( 1 );
			break;
		end;	
	end;
end;

function GB_attack()
	Wait( 2 );
	LandReinforcementFromMap( 1, &quot;GB_INF&quot;, 1, 5081 ); 
	Wait( 2 );
	ChangeFormation( 5081, 3 );
	Wait( 3 );
	Cmd( 3, 5081, 0, 10372, 864 );
	QCmd( 3, 5081, 0, 11398, 426 );
end;
------------------------------------------------------Mobile
function Mob_art()
	while 1 do
		Wait( 2 );
		if (GetNUnitsInArea(0, &quot;Mobile&quot;, 0) &gt; 0) then
			Wait( 1 );
			StartThread( Mobile_move_1 );
			StartThread( Mobile_move_2 );
			Wait( 1 );
			break;
		end;	
	end;
end;

function Mobile_move_1()
	Wait( 1 );
	Cmd( 0, 199, 0, 7202, 5590 );
	QCmd( 8, 199, 0, 7401, 5280 );
	QCmd( 45, 199, 0, 7401, 5280 );
end;

function Mobile_move_2()
	Wait( 1 );
	Cmd( 0, 198, 0, 7336, 5664 );
	QCmd( 8, 198, 0, 7501, 4667 );
	QCmd( 45, 198, 0, 7501, 4667 );
end;
--------------------------------------------------------------------GB_INF_RETREAT
function Retreat_1()
	while 1 do
		Wait( 2 );
		if ( GetNUnitsInScriptGroup( 281 ) &lt; 6 ) then
			Wait( 2 );
			Cmd( 0, 281, 0, 9967, 3149 );
			ChangeFormation( 281, 1 );
			QCmd( 0, 281, 0, 9306, 6626 );
			Wait( 1 );
			break;
		end;	
	end;
end;

function GB_infantry()
	while 1 do
		Wait( 3 );
		if ((GetIGlobalVar(&quot;temp.objective3&quot;, 1) ~= 2) and (GetIGlobalVar(&quot;temp.objective0&quot;, 1) == 2) and ( GetNUnitsInScriptGroup( 5088 ) &lt; 1 )) then
			Wait( 2 );
			GiveObjective( 1 );
			StartThread( GB_inf_attack );
			break;
		end;	
	end;
end;

function GB_inf_attack()
	Wait( 2 );
	LandReinforcementFromMap( 1, &quot;GB_INF&quot;, 0, 5088 ); 
	Wait( 2 );
	ChangeFormation( 5088, 3 );
	Wait( 5 );
	Cmd( 3, 5088, 500, 3671, 4994 );
	QCmd( 3, 5088, 0, 5485, 1253 );
	QCmd( 3, 5088, 0, 9952, 4056 );
	QCmd( 3, 5088, 0, 10930, 442 );
	Wait( 180 );
	StartThread( GB_infantry );
end;
------------------------------------------------------It_tanks_grant

function Grant_at()
	while 1 do
		Wait( 3 );
		if ((GetIGlobalVar(&quot;temp.objective1&quot;, 1) == 2) and ( GetNUnitsInScriptGroup( 222 ) &gt; 4 )) then
			Wait( 3 );
			LandReinforcementFromMap( 2, &quot;IT_TANKS&quot;, 0, 710 );
			LandReinforcementFromMap( 2, &quot;IT_TANKS&quot;, 1, 711 );
			LandReinforcementFromMap( 2, &quot;IT_TANKS&quot;, 2, 712 );
			Wait( 3 );
				Cmd ( 3 , 710 , 0 , GetScriptAreaParams&quot;IT1&quot; );
				Cmd ( 3 , 711 , 0 , GetScriptAreaParams&quot;IT1_1&quot; );
				Cmd ( 3 , 712 , 0 , GetScriptAreaParams&quot;IT1_2&quot; );
				QCmd ( 3 , 710 , 0 , GetScriptAreaParams&quot;IT2&quot; );
				QCmd ( 3 , 711 , 0 , GetScriptAreaParams&quot;IT2&quot; );
				QCmd ( 3 , 712 , 0 , GetScriptAreaParams&quot;IT2&quot; );
				QCmd ( 3 , 710 , 0 , GetScriptAreaParams&quot;IT2_2&quot; );
				QCmd ( 3 , 711 , 0 , GetScriptAreaParams&quot;IT2_2&quot; );
				QCmd ( 3 , 712 , 0 , GetScriptAreaParams&quot;IT2_2&quot; );
			break;
		end;	
	end;
end;

----------------------------------------------------- MAIN

StartThread( RevealObjective0 );
StartThread( RevealObjective1 );
StartThread( RevealObjective2 );
StartThread( RevealObjective3 );
StartThread( RevealObjective4 );

StartThread( Winner );
StartThread( Unlucky );
StartThread( Attack_I );
StartThread( Attack_Avia );

StartThread( Mob_art );
StartThread( Retreat_1 );
StartThread( GB_infantry );
StartThread( Grant_at );

--StartThread( StartGB );
StartThread( Fort_Def );</ScriptText>
</Script>
