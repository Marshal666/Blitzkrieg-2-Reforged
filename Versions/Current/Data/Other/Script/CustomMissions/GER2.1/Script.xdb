<?xml version="1.0" encoding="UTF-8" ?>
<Script ObjectRecordID="164">
		<FileName />
		<ScriptText>TankCaptured = 0;
---------------- OBJECTIVE 0 ------------------ begin

function Arriving()
	--Wait(2);
	--Cmd(ACT_MOVE, 141, 1, 2273, 1320);
	Wait(1);
	Cmd(ACT_MOVE, 1079, 1, 2193, 1366);
	QCmd(ACT_UNLOAD, 1079, 1, 2273, 1320);
	--ChangePlayer(GetObjectList(1080),0);
	Wait(25);
	Cmd(ACT_MOVE, 1079, 1, 100, 1400);
	QCmd(ACT_DISAPPEAR, 1079);
end;

function LightOff()
	while 1 do 
	Wait(3);
	--Trace(&quot;LightOff...&quot;);
	SwitchSquadLightFX(901,0);
	Wait(1);
	SwitchSquadLightFX(930,0);
	Wait(1);
	if (TankCaptured == 0) then
		SwitchSquadLightFX(931,0);
	end;
	end;
end;

function CaptureTank()
	while 1 do
		Wait(1);
		if (GetNUnitsInArea(0, &quot;tanks&quot;, 0) &gt; 0) then
			
			SwitchSquadLightFX(931,1);
			ChangePlayer(GetObjectList(931), 0);
		end;
	end;
end;

function CaptureTankTest()
	while 1 do
		Wait(1);
		if (GetNUnitsInArea(0, &quot;tanks&quot;, 0) &gt; 0) then
			Wait(1);
			UnitsArr = GetUnitListInAreaArray(0,&quot;tanks&quot;,0);
			UnitCmd(ACT_DISAPPEAR, UnitsArr[1]);
			Trace(&quot;Unit has disappeared&quot;);
			SwitchSquadLightFX(931,1);
			TankCaptured = 1;
			ChangePlayer(GetObjectList(931), 0);
			break;
		end;
	end;
end;
---- capture building
function RevealObjective0()
    Wait(2);
	ObjectiveChanged(0, 1);
	Wait(3);
	StartThread( lose );
end;


function Objective0()
	if (GetNUnitsInArea(0, &quot;KeyBuilding&quot;,0) &gt; 0 and GetNUnitsInArea(1, &quot;KeyBuilding&quot;,0) &lt; 1) then
		return 1;
    end;
end;

function CompleteObjective0()
	ObjectiveChanged(0, 2);
	Wait(1);
	--LandReinforcement(0, 0, 1, 555);
	StartThread( RevealObjective1 );
	Trigger( Objective1, CompleteObjective1 );
end;
---------------- OBJECTIVE 0 ------------------ end

---------------- OBJECTIVE 1 ------------------ begin
---- destroy storage
function RevealObjective1()
    Wait(5);
	ObjectiveChanged(1, 1);
end;


function Objective1()
	if ( ( GetScriptObjectHPs( 1001 ) &lt; 1 ) and ( GetScriptObjectHPs( 1002 ) &lt; 1 ) and ( GetScriptObjectHPs( 1003 ) &lt; 1 ) ) then
        return 1;
    end;
end;


function CompleteObjective1()
	Wait(5);
	ObjectiveChanged(1, 2);
	Wait(3);
	Win(0);
end;
---------------- OBJECTIVE 1 ------------------ end

---------------- WILLIS RETREAT --------------- begin
function willis_retreat()
	if (IsAlive(GetObjectList(113)) == 0) then
		return 1;
	end;
end;

function willis()
	DisplayTrace(GetObjectHPs(102));
	if ( GetObjectHPs(102) &gt; 0) then
		Cmd (ACT_MOVE, 102, 1, 2988, 5491);
		Wait(2);
		QCmd (ACT_MOVE, 102, 1, 3326, 6767);
		Wait(5);
		QCmd (ACT_MOVE, 102, 1, 5436, 6823);
		Wait(3);
	end;	
end;
---------------- WILLIS RETREAT --------------- end

---------------- HUMBER SWARM ----------------- begin
function humber_swarm()
	if (IsUnitInArea(1, &quot;DesertGuard2&quot;, GetObjectList(102)) == 1) then
		return 1;
	end;
end;

function humber_swarm_go()
	--Trace (&quot;Humber attack!&quot;);
	Wait(4);
	Cmd (ACT_SWARM, 103, 1, 3707, 1649);
end;
---------------- HUMBER SWARM ----------------- end


---------------- DESERT PATROL ---------------- begin
function WillisArrive()
	if (IsUnitInArea(1, &quot;WillisArrive&quot;, GetObjectList(102)) == 1) then
		return 1;
	end;
end;

function start()
	--Trace(&quot;Willis has arrived...&quot;);
	Wait(20);
	StartThread(Patrol_Start);
	StartThread(Patrol_Start2);
end;

function Patrol_Start()
	while 1 do
		Wait(3);
		if (GetObjectHPs(112) &gt; 0 and ((GetNScriptUnitsInArea(112, &quot;JeepStart&quot;, 0) &gt; 0) or (GetNScriptUnitsInArea(112, &quot;DesertGuard2&quot;) &gt; 0))) then
		Wait( 1 );
		--Trace(&quot;Jeep 112 start&quot;);
		StartThread( DesertPatrol );
		break;
		end;
	end;
end;


function DesertPatrol()
	Cmd (ACT_SWARM, 112, 1, 5560, 6733);
	Wait(5);
	--Trace(&quot;Thread DesertPatrol 1&quot;);
	QCmd (ACT_SWARM, 112, 1, 7094, 6631);
	Wait(5);
	QCmd (ACT_SWARM, 112, 1, 7260, 3876);
	Wait(5);
	QCmd (ACT_SWARM, 112, 1, 6502, 1890);
	Wait(5);
	QCmd (ACT_SWARM, 112, 1, 3880, 1595);
	Wait(5);
	QCmd (ACT_SWARM, 112, 1, 3087, 5034);
	Wait(5);
	QCmd (ACT_SWARM, 112, 1, 3481, 6785);
	Wait(5);
	StartThread(Patrol_Start);
end;

function Patrol_Start2()
	while 1 do
		Wait(3);
		if (GetObjectHPs(106) &gt; 0 and ((GetNScriptUnitsInArea(106, &quot;JeepStart&quot;, 0) &gt; 0) or (GetNScriptUnitsInArea(106, &quot;JeepPatrol&quot;, 0) &gt; 0))) then
		Wait( 1 );
		--Trace(&quot;Jeep 106 start&quot;);
		StartThread( DesertPatrol2 );
		break;
		end;
	end;
end;

function DesertPatrol2()	
	Cmd (ACT_SWARM, 106, 1, 5560, 6733);
	Wait(5);
	--Trace(&quot;Thread DesertPatrol 2&quot;);
	QCmd (ACT_SWARM, 106, 1, 3481, 6785);
	Wait(5);
	QCmd (ACT_SWARM, 106, 1, 3087, 5034);
	Wait(5);
	QCmd (ACT_SWARM, 106, 1, 3880, 1595);
	Wait(5);
	QCmd (ACT_SWARM, 106, 1, 6502, 1890);
	Wait(5);
	QCmd (ACT_SWARM, 106, 1, 7260, 3876);
	Wait(5);
	QCmd (ACT_SWARM, 106, 1, 7094, 6631);
	Wait(5);
	StartThread(Patrol_Start2);
end;
---------------- DESERT PATROL ---------------- end

---------------- INFANTRY SWARM --------------- begin
function infantry()
	while 1 do 
		Wait(1);
		if (GetNScriptUnitsInArea(140, &quot;JeepStart&quot;, 0) &gt; 0) then
			--Trace(&quot;banzai&quot;);
			Cmd (ACT_SWARM, 108, 1, 7191, 6241);
			QCmd (ACT_SWARM, 108, 1, 7244, 4199);
			break;
		end;
	end;
end;
---------------- INFANTRY SWARM --------------- end


---------------- BASE GUARD ------------------- begin
function Base_Guard()
	while 1 do
		Wait(3);
		if (GetObjectHPs(110) &gt; 0 and GetNScriptUnitsInArea(110, &quot;BaseGuard&quot;,0) &gt; 0) then
		Wait( 1 );
		StartThread( Base_Guard_go );
		break;
		end;
	end;
end;

function Base_Guard_go()
	Cmd (ACT_SWARM, 110, 1, 7093, 6678);
	Wait(5);
	QCmd (ACT_SWARM, 110, 1, 3532, 6837);
	Wait(5);
	StartThread(Base_Guard);
end;
---------------- BASE GUARD ------------------- end

---------------- DESERT GUARD ----------------- begin
function Desert_Guard()
	while 1 do
		Wait(3);
		if (IsAlive(GetObjectList(109)) == 1 and GetNScriptUnitsInArea(109, &quot;DesertGuard&quot;,0) &gt; 0) then
		Wait( 1 );
		StartThread( Desert_Guard_go );
		break;
		end;
	end;
end;

function Desert_Guard_go()
	Cmd (ACT_SWARM, 109, 1, 5793, 3878);
	Wait(5);
	QCmd (ACT_SWARM, 109, 1, 6403, 1965);
	Wait(5);
	QCmd (ACT_SWARM, 109, 1, 7637, 350);
	Wait(5);
	QCmd (ACT_SWARM, 109, 1, 7093, 6065);
	Wait(5);
	StartThread(Desert_Guard);
end;
---------------- DESERT GUARD ----------------- end

---------------- BOT -------------------------- begin
function bot()
	while 1 do
		Wait(3);
		if (IsAlive(GetObjectList(10001)) == 1 and GetNScriptUnitsInArea(10001, &quot;bot&quot;,0) &gt; 0) then
		Wait( 1 );
		StartThread( bot_go );
		break;
		end;
	end;
end;

function bot_go()
	Cmd (ACT_SWARM, 10001, 1, 1038, 1799);
	Wait(5);
	QCmd (ACT_SWARM, 10001, 1, 575, 7211);
	Wait(5);
end;

---------------- BOT -------------------------- end

---------------- TRUCK RETREAT ---------------- begin
function TruckRetreat()
	while 1 do 
	Wait(1);
		if (GetNUnitsInArea(0, &quot;truckRetreat&quot;, 0) &gt; 0) then
			Cmd(ACT_MOVE, 140, 1, 6915, 6535);
			QCmd(ACT_MOVE, 140, 1, 4402, 7614);
			StartThread(infantry);
			break;
		end;
	end;
end;

---------------- TRUCK RETREAT ---------------- end



---------------- WIN -------------------------- begin
function win()
	while 1 do
            if ( GetNUnitsInParty(1) &lt; 1 ) then
				Wait(2);
				Win (0);
         return 1;
	end;
	Wait(5);
	end;
end;
---------------- WIN -------------------------- end

---------------- LOOSE ------------------------ begin
function lose()
	while 1 do
            if ( GetNUnitsInParty(0) &lt; 1 and GetReinforcementCallsLeft(0) &lt; 1) then
                Trace(&quot;My proigrali!!!&quot;);
				Wait(2);
				Loose(0);
         return 1;
	end;
	Wait(5);
	end;
end;
---------------- LOOSE ------------------------ end
StartThread(CaptureTankTest);StartThread(Arriving);
StartThread(LightOff);
--StartThread(CaptureTank);
StartThread(win);
StartThread(bot);
StartThread(Base_Guard);
StartThread(Desert_Guard);
StartThread(TruckRetreat);
StartThread(RevealObjective0);
Trigger(Objective0, CompleteObjective0);
Trigger(humber_swarm, humber_swarm_go);
Trigger (willis_retreat, willis);
Trigger(WillisArrive, start);</ScriptText>
	</Script>
